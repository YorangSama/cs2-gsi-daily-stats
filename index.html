<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS:GO 僵尸模式状态显示</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-color: transparent;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .team-panel {
            background: linear-gradient(145deg, rgba(22, 33, 62, 0.95), rgba(15, 52, 96, 0.95));
            border-radius: 15px;
            padding: 30px;
            width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            border: 3px solid #0f3460;
            transition: all 0.3s ease;
        }
        
        .team-panel.human {
            border-color: #3498db;
            background: linear-gradient(145deg, rgba(22, 33, 62, 0.95), rgba(15, 52, 96, 0.95));
        }
        
        .team-panel.zombie {
            border-color: #e74c3c;
            background: linear-gradient(145deg, rgba(62, 22, 22, 0.95), rgba(96, 15, 15, 0.95));
        }
        
        .team-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .team-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 0 0 10px currentColor;
        }
        
        .human .team-title {
            color: #3498db;
        }
        
        .zombie .team-title {
            color: #e74c3c;
        }
        
        .team-subtitle {
            font-size: 18px;
            color: #aaa;
            margin-bottom: 15px;
        }
        
        .status {
            font-size: 14px;
            color: #ccc;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
            vertical-align: middle;
        }
        
        .connected {
            background-color: #2ecc71;
            box-shadow: 0 0 10px #2ecc71;
        }
        
        .disconnected {
            background-color: #e74c3c;
            box-shadow: 0 0 10px #e74c3c;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.07);
            padding: 18px;
            border-radius: 12px;
            border-left: 5px solid;
            transition: all 0.3s ease;
        }
        
        .stat-item:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.12);
        }
        
        .human .stat-item {
            border-left-color: #3498db;
        }
        
        .zombie .stat-item {
            border-left-color: #e74c3c;
        }
        
        .stat-label {
            font-size: 16px;
            color: #bbb;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        .health-value {
            color: #2ecc71;
        }
        
        .armor-value {
            color: #3498db;
        }
        
        .money-value {
            color: #f1c40f;
        }
        
        .kills-value {
            color: #e74c3c;
        }
        
        .hs-value {
            color: #9b59b6;
        }
        
        /* 统计总数显示 */
        .total-stats {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .total-stats h3 {
            text-align: center;
            color: #3498db;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .total-numbers {
            display: flex;
            justify-content: space-around;
        }
        
        .total-item {
            text-align: center;
        }
        
        .total-item .label {
            font-size: 14px;
            color: #aaa;
        }
        
        .total-item .value {
            font-size: 22px;
            font-weight: bold;
            color: #f1c40f;
        }
    </style>
</head>
<body>
    <!-- 单一面板：根据队伍动态变化 -->
    <div class="team-panel" id="teamPanel">
        <div class="team-header">
            <div class="team-title" id="teamName">等待连接...</div>
            <div class="team-subtitle" id="teamType">CS:GO 僵尸模式</div>
            <div class="status">
                状态: <span id="statusText">等待游戏数据...</span>
                <span id="statusIndicator" class="status-indicator disconnected"></span>
            </div>
        </div>
        
        <div class="stats-grid">
            <!-- 队伍信息 -->
            <div class="stat-item">
                <div class="stat-label">队伍</div>
                <div class="stat-value" id="team">-</div>
            </div>
            
            <!-- 血量（两个队伍都显示） -->
            <div class="stat-item">
                <div class="stat-label">血量</div>
                <div class="stat-value health-value" id="health">-</div>
            </div>
            
            <!-- 金钱（两个队伍都显示） -->
            <div class="stat-item">
                <div class="stat-label">金钱</div>
                <div class="stat-value money-value" id="money">-</div>
            </div>
            
            <!-- 护甲（仅僵尸队伍显示） -->
            <div class="stat-item" id="armorItem" style="display: none;">
                <div class="stat-label">护甲</div>
                <div class="stat-value armor-value" id="armor">-</div>
            </div>
            
            <!-- 回合击杀（仅人类队伍显示） -->
            <div class="stat-item" id="killsItem" style="display: none;">
                <div class="stat-label">回合击杀</div>
                <div class="stat-value kills-value" id="kills">-</div>
            </div>
            
            <!-- 回合爆头击杀（仅人类队伍显示） -->
            <div class="stat-item" id="hsItem" style="display: none;">
                <div class="stat-label">回合爆头击杀</div>
                <div class="stat-value hs-value" id="hs">-</div>
            </div>
        </div>
        
        <!-- 总统计数据（仅人类显示） -->
        <div class="total-stats" id="totalStats" style="display: none;">
            <h3>今日总击杀统计</h3>
            <div class="total-numbers">
                <div class="total-item">
                    <div class="label">总击杀</div>
                    <div class="value" id="totalKills">0</div>
                </div>
                <div class="total-item">
                    <div class="label">总爆头</div>
                    <div class="value" id="totalHs">0</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        // 连接WebSocket服务器
        const socket = io();
        
        // DOM元素
        const teamPanel = document.getElementById('teamPanel');
        const teamName = document.getElementById('teamName');
        const teamType = document.getElementById('teamType');
        const statusText = document.getElementById('statusText');
        const statusIndicator = document.getElementById('statusIndicator');
        const teamDisplay = document.getElementById('team');
        const healthDisplay = document.getElementById('health');
        const moneyDisplay = document.getElementById('money');
        const armorDisplay = document.getElementById('armor');
        const killsDisplay = document.getElementById('kills');
        const hsDisplay = document.getElementById('hs');
        
        // 可选显示项目
        const armorItem = document.getElementById('armorItem');
        const killsItem = document.getElementById('killsItem');
        const hsItem = document.getElementById('hsItem');
        const totalStats = document.getElementById('totalStats');
        const totalKills = document.getElementById('totalKills');
        const totalHs = document.getElementById('totalHs');
        
        // 连接状态
        socket.on('connect', () => {
            console.log('已连接到服务器');
            statusText.textContent = '已连接';
            statusIndicator.className = 'status-indicator connected';
        });
        
        socket.on('disconnect', () => {
            console.log('与服务器断开连接');
            statusText.textContent = '连接断开';
            statusIndicator.className = 'status-indicator disconnected';
        });
        
        // 接收游戏状态更新
        socket.on('game_state_update', (data) => {
            console.log('收到游戏数据:', data);
            
            // 更新连接状态
            statusText.textContent = '数据更新中';
            statusIndicator.className = 'status-indicator connected';
            
            // 根据队伍类型切换面板样式
            if (data.team === '人类') {
                // 人类队伍样式
                teamPanel.className = 'team-panel human';
                teamName.textContent = '人类队伍';
                teamType.textContent = 'CT - 反恐精英';
                teamDisplay.textContent = data.team;
                
                // 显示人类特有信息
                healthDisplay.textContent = data.health;
                moneyDisplay.textContent = '$' + data.money;
                
                // 显示回合击杀和爆头
                killsItem.style.display = 'block';
                hsItem.style.display = 'block';
                armorItem.style.display = 'none';
                
                killsDisplay.textContent = data.round_kills;
                hsDisplay.textContent = data.round_killhs;
                
                // 显示总统计
                totalStats.style.display = 'block';
                
                // 获取总击杀统计
                fetch('/stats')
                    .then(response => response.json())
                    .then(stats => {
                        totalKills.textContent = stats.total_kills;
                        totalHs.textContent = stats.total_hs;
                    })
                    .catch(error => {
                        console.error('获取总统计失败:', error);
                    });
                    
            } else if (data.team === '僵尸') {
                // 僵尸队伍样式
                teamPanel.className = 'team-panel zombie';
                teamName.textContent = '僵尸队伍';
                teamType.textContent = 'T - 恐怖分子';
                teamDisplay.textContent = data.team;
                
                // 显示僵尸信息
                healthDisplay.textContent = data.health;
                moneyDisplay.textContent = '$' + data.money;
                armorDisplay.textContent = data.armor;
                
                // 显示护甲，隐藏击杀统计
                armorItem.style.display = 'block';
                killsItem.style.display = 'none';
                hsItem.style.display = 'none';
                totalStats.style.display = 'none';
                
            } else {
                // 默认状态
                teamPanel.className = 'team-panel';
                teamName.textContent = '等待游戏数据';
                teamType.textContent = 'CS:GO 僵尸模式';
                teamDisplay.textContent = '-';
                healthDisplay.textContent = '-';
                moneyDisplay.textContent = '-';
                
                // 隐藏所有可选项目
                armorItem.style.display = 'none';
                killsItem.style.display = 'none';
                hsItem.style.display = 'none';
                totalStats.style.display = 'none';
            }
        });
        
        // 页面加载时获取当前信息
        window.addEventListener('load', () => {
            fetch('/current_info')
                .then(response => response.json())
                .then(data => {
                    if (data.team) {
                        // 模拟接收数据以更新界面
                        socket.emit('game_state_update', data);
                    }
                })
                .catch(error => {
                    console.error('获取当前信息失败:', error);
                });
        });
    </script>
</body>
</html>